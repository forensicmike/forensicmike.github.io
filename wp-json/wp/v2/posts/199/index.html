{"id":199,"date":"2019-05-19T14:04:09","date_gmt":"2019-05-19T21:04:09","guid":{"rendered":"https:\/\/3.88.229.156\/?p=199"},"modified":"2019-05-19T18:49:24","modified_gmt":"2019-05-20T01:49:24","slug":"a-lesson-in-home-network-security","status":"publish","type":"post","link":"http:\/\/172.31.17.250\/2019\/05\/19\/a-lesson-in-home-network-security\/","title":{"rendered":"A lesson in home network security"},"content":{"rendered":"\n<p>There&#8217;s been a lot of buzz about <a rel=\"noreferrer noopener\" aria-label=\"RDP vulnerabilities (opens in a new tab)\" href=\"https:\/\/blogs.technet.microsoft.com\/msrc\/2019\/05\/14\/prevent-a-worm-by-updating-remote-desktop-services-cve-2019-0708\/\" target=\"_blank\">RDP vulnerabilities<\/a> of late, and one tweet in particular publicly shamed companies who in 2019 were still using port forwarding to remotely access machines on their corporate LANs. I thought, they&#8217;re talking about <em>companies, <\/em>not regular joes. But the tweet stuck with me and eventually motivated me to take a small step towards improved security. I&#8217;ll admit it! I&#8217;ve had a random (non-3389) port forwarded to a machine on my LAN to facilitate RDP connections for some time, really just for the sheer convenience and cost effectiveness of it. I selected a port that isn&#8217;t commonly used for anything, to help prevent it from showing up on Shodan or any common-only type port scans. It gave me a &#8216;security through obscurity&#8217; level of confidence that others probably share about their home LANs. I googled easy ways to improve RDP security and came across <a rel=\"noreferrer noopener\" aria-label=\"this guide (opens in a new tab)\" href=\"https:\/\/www.tenforums.com\/tutorials\/87609-change-account-lockout-threshold-local-accounts-windows-10-a.html\" target=\"_blank\">this guide<\/a> which walks you through how to set local policy that automatically locks accounts out after so many failed login attempts. I went ahead and set this up on the box I RDP to. On that box, I had only 1 <strong>local<\/strong> account which was part of the Administrator group. Today, I went to login to the machine and got this (image from Google images):<\/p>\n\n\n\n<figure class=\"wp-block-image\"><a href=\"http:\/\/3.88.229.156\/wp-content\/uploads\/2019\/05\/AD_Account_Keeps_Locking_Out.jpg\"><img loading=\"lazy\" width=\"474\" height=\"205\" src=\"http:\/\/3.88.229.156\/wp-content\/uploads\/2019\/05\/AD_Account_Keeps_Locking_Out.jpg\" alt=\"\" class=\"wp-image-200\" srcset=\"http:\/\/172.31.17.250\/wp-content\/uploads\/2019\/05\/AD_Account_Keeps_Locking_Out.jpg 474w, http:\/\/172.31.17.250\/wp-content\/uploads\/2019\/05\/AD_Account_Keeps_Locking_Out-300x130.jpg 300w\" sizes=\"(max-width: 474px) 100vw, 474px\" \/><\/a><\/figure>\n\n\n\n<p>OK, I thought, there could be a non-scary explanation for this &#8212; maybe a scheduled task I created with stored credentials and completely forgot about or something? <\/p>\n\n\n\n<p class=\"has-small-font-size\"><em>Side note &#8212; when you are literally the only user that can login on a machine and get locked out, it&#8217;s a pain in the ass to fix! The login screen won&#8217;t let you login as any other user and even password resets do not unlock it. I booted to recovery and launched a command prompt, but wasn&#8217;t able to see my locked out account from there using net user &#8212; it listed other accounts but not the problem one.<\/em> <em>The fix I finally used was to replace utilman.exe with cmd.exe in the recovery command prompt and boot normally<\/em>, <em>then clicked the &#8216;ease of access&#8217; to have an administrator command prompt on a normal boot<\/em>, <em>which was able to set the user account to active again.<\/em><\/p>\n\n\n\n<p>Alright so, we&#8217;re unlocked now and all is back to normal, right? As a forensics guy I really wanted to discover what caused the lockout. I opened up Event viewer and checked out the Security logs. What I observed next stunned me. In the 12 days before all this happened, I had over 14,000 failed attempts to logon via RDP. Further inspection showed that the failed attempts were often coupled with random account names that could only be part of a dictionary attack. I exported the list and wrote a C# script to itemize the names used, and put them in a pastebin <a rel=\"noreferrer noopener\" aria-label=\"here (opens in a new tab)\" href=\"https:\/\/pastebin.com\/S64qNi7V\" target=\"_blank\">here<\/a> if anyone is interested. ADMINISTRATOR is the clear winner with over 9611 failed logins.<\/p>\n\n\n\n<p>This led me on a &#8216;security improvement&#8217; rabbit hole that included:<\/p>\n\n\n\n<ul><li>Disabling port forwarding altogether on my router<\/li><li>Running nmap on my machine and finding ports open somehow.<\/li><li>Discovering that UPnP was enabled on my router and disabling it &#8211; really?<\/li><li>Going through the ASUS Security Checklist and turning everything green, such as changing my &#8216;admin&#8217; username to something else, disabling WPS, enabling HTTPS-only access to the router, updating router firmware to the latest version, etc.<\/li><\/ul>\n\n\n\n<p>While there&#8217;s no evidence at this point of successful access to my machine, I felt like this was an excellent wakeup call. As for remoting, I am going to disable RDP and instead use a third party remoting service &#8212; one which allows me to use 2FA and has &#8216;login attempt from X.X.X.X&#8217; notification emails, etc.<\/p>\n","protected":false},"excerpt":{"rendered":"<p>There&#8217;s been a lot of buzz about RDP vulnerabilities of late, and one tweet in particular publicly shamed companies who in 2019 were still using port forwarding to remotely access machines on their corporate LANs. I thought, they&#8217;re talking about companies, not regular joes. But the tweet stuck with me and eventually motivated me to [&hellip;]<\/p>\n","protected":false},"author":2,"featured_media":212,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"_mi_skip_tracking":false},"categories":[25,1],"tags":[24,22,23],"yoast_head":"<!-- This site is optimized with the Yoast SEO plugin v19.4 - https:\/\/yoast.com\/wordpress\/plugins\/seo\/ -->\n<title>A lesson in home network security - forensicmike1<\/title>\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" \/>\n<link rel=\"canonical\" href=\"https:\/\/52.72.64.130\/2019\/05\/19\/a-lesson-in-home-network-security\/\" \/>\n<meta property=\"og:locale\" content=\"en_US\" \/>\n<meta property=\"og:type\" content=\"article\" \/>\n<meta property=\"og:title\" content=\"A lesson in home network security - forensicmike1\" \/>\n<meta property=\"og:description\" content=\"There&#8217;s been a lot of buzz about RDP vulnerabilities of late, and one tweet in particular publicly shamed companies who in 2019 were still using port forwarding to remotely access machines on their corporate LANs. I thought, they&#8217;re talking about companies, not regular joes. But the tweet stuck with me and eventually motivated me to [&hellip;]\" \/>\n<meta property=\"og:url\" content=\"https:\/\/52.72.64.130\/2019\/05\/19\/a-lesson-in-home-network-security\/\" \/>\n<meta property=\"og:site_name\" content=\"forensicmike1\" \/>\n<meta property=\"article:published_time\" content=\"2019-05-19T21:04:09+00:00\" \/>\n<meta property=\"article:modified_time\" content=\"2019-05-20T01:49:24+00:00\" \/>\n<meta property=\"og:image\" content=\"https:\/\/52.72.64.130\/wp-content\/uploads\/2019\/05\/hacked.png\" \/>\n\t<meta property=\"og:image:width\" content=\"364\" \/>\n\t<meta property=\"og:image:height\" content=\"148\" \/>\n\t<meta property=\"og:image:type\" content=\"image\/png\" \/>\n<meta name=\"author\" content=\"Mike Williamson\" \/>\n<meta name=\"twitter:card\" content=\"summary_large_image\" \/>\n<meta name=\"twitter:creator\" content=\"@forensicmike1\" \/>\n<meta name=\"twitter:label1\" content=\"Written by\" \/>\n\t<meta name=\"twitter:data1\" content=\"Mike Williamson\" \/>\n\t<meta name=\"twitter:label2\" content=\"Est. reading time\" \/>\n\t<meta name=\"twitter:data2\" content=\"3 minutes\" \/>\n<script type=\"application\/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https:\/\/schema.org\",\"@graph\":[{\"@type\":\"WebSite\",\"@id\":\"http:\/\/172.31.17.250\/#website\",\"url\":\"http:\/\/172.31.17.250\/\",\"name\":\"forensicmike1\",\"description\":\"#DFIR | #RE | #OtherGeekThings =&gt; Views expressed are my own.\",\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":{\"@type\":\"EntryPoint\",\"urlTemplate\":\"http:\/\/172.31.17.250\/?s={search_term_string}\"},\"query-input\":\"required name=search_term_string\"}],\"inLanguage\":\"en-US\"},{\"@type\":\"WebPage\",\"@id\":\"https:\/\/52.72.64.130\/2019\/05\/19\/a-lesson-in-home-network-security\/\",\"url\":\"https:\/\/52.72.64.130\/2019\/05\/19\/a-lesson-in-home-network-security\/\",\"name\":\"A lesson in home network security - forensicmike1\",\"isPartOf\":{\"@id\":\"http:\/\/172.31.17.250\/#website\"},\"datePublished\":\"2019-05-19T21:04:09+00:00\",\"dateModified\":\"2019-05-20T01:49:24+00:00\",\"author\":{\"@id\":\"http:\/\/172.31.17.250\/#\/schema\/person\/9452bbb839546322f3705877143ce492\"},\"breadcrumb\":{\"@id\":\"https:\/\/52.72.64.130\/2019\/05\/19\/a-lesson-in-home-network-security\/#breadcrumb\"},\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https:\/\/52.72.64.130\/2019\/05\/19\/a-lesson-in-home-network-security\/\"]}]},{\"@type\":\"BreadcrumbList\",\"@id\":\"https:\/\/52.72.64.130\/2019\/05\/19\/a-lesson-in-home-network-security\/#breadcrumb\",\"itemListElement\":[{\"@type\":\"ListItem\",\"position\":1,\"name\":\"Home\",\"item\":\"http:\/\/172.31.17.250\/\"},{\"@type\":\"ListItem\",\"position\":2,\"name\":\"A lesson in home network security\"}]},{\"@type\":\"Person\",\"@id\":\"http:\/\/172.31.17.250\/#\/schema\/person\/9452bbb839546322f3705877143ce492\",\"name\":\"Mike Williamson\",\"image\":{\"@type\":\"ImageObject\",\"inLanguage\":\"en-US\",\"@id\":\"http:\/\/172.31.17.250\/#\/schema\/person\/image\/\",\"url\":\"http:\/\/2.gravatar.com\/avatar\/540f47dd0fb41a572604e4bf8594c723?s=96&d=mm&r=g\",\"contentUrl\":\"http:\/\/2.gravatar.com\/avatar\/540f47dd0fb41a572604e4bf8594c723?s=96&d=mm&r=g\",\"caption\":\"Mike Williamson\"},\"sameAs\":[\"https:\/\/3.88.229.156\",\"https:\/\/twitter.com\/forensicmike1\"],\"url\":\"http:\/\/172.31.17.250\/author\/forensicmike\/\"}]}<\/script>\n<!-- \/ Yoast SEO plugin. -->","yoast_head_json":{"title":"A lesson in home network security - forensicmike1","robots":{"index":"index","follow":"follow","max-snippet":"max-snippet:-1","max-image-preview":"max-image-preview:large","max-video-preview":"max-video-preview:-1"},"canonical":"https:\/\/52.72.64.130\/2019\/05\/19\/a-lesson-in-home-network-security\/","og_locale":"en_US","og_type":"article","og_title":"A lesson in home network security - forensicmike1","og_description":"There&#8217;s been a lot of buzz about RDP vulnerabilities of late, and one tweet in particular publicly shamed companies who in 2019 were still using port forwarding to remotely access machines on their corporate LANs. I thought, they&#8217;re talking about companies, not regular joes. But the tweet stuck with me and eventually motivated me to [&hellip;]","og_url":"https:\/\/52.72.64.130\/2019\/05\/19\/a-lesson-in-home-network-security\/","og_site_name":"forensicmike1","article_published_time":"2019-05-19T21:04:09+00:00","article_modified_time":"2019-05-20T01:49:24+00:00","og_image":[{"width":364,"height":148,"url":"https:\/\/52.72.64.130\/wp-content\/uploads\/2019\/05\/hacked.png","type":"image\/png"}],"author":"Mike Williamson","twitter_card":"summary_large_image","twitter_creator":"@forensicmike1","twitter_misc":{"Written by":"Mike Williamson","Est. reading time":"3 minutes"},"schema":{"@context":"https:\/\/schema.org","@graph":[{"@type":"WebSite","@id":"http:\/\/172.31.17.250\/#website","url":"http:\/\/172.31.17.250\/","name":"forensicmike1","description":"#DFIR | #RE | #OtherGeekThings =&gt; Views expressed are my own.","potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"http:\/\/172.31.17.250\/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"WebPage","@id":"https:\/\/52.72.64.130\/2019\/05\/19\/a-lesson-in-home-network-security\/","url":"https:\/\/52.72.64.130\/2019\/05\/19\/a-lesson-in-home-network-security\/","name":"A lesson in home network security - forensicmike1","isPartOf":{"@id":"http:\/\/172.31.17.250\/#website"},"datePublished":"2019-05-19T21:04:09+00:00","dateModified":"2019-05-20T01:49:24+00:00","author":{"@id":"http:\/\/172.31.17.250\/#\/schema\/person\/9452bbb839546322f3705877143ce492"},"breadcrumb":{"@id":"https:\/\/52.72.64.130\/2019\/05\/19\/a-lesson-in-home-network-security\/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https:\/\/52.72.64.130\/2019\/05\/19\/a-lesson-in-home-network-security\/"]}]},{"@type":"BreadcrumbList","@id":"https:\/\/52.72.64.130\/2019\/05\/19\/a-lesson-in-home-network-security\/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"http:\/\/172.31.17.250\/"},{"@type":"ListItem","position":2,"name":"A lesson in home network security"}]},{"@type":"Person","@id":"http:\/\/172.31.17.250\/#\/schema\/person\/9452bbb839546322f3705877143ce492","name":"Mike Williamson","image":{"@type":"ImageObject","inLanguage":"en-US","@id":"http:\/\/172.31.17.250\/#\/schema\/person\/image\/","url":"http:\/\/2.gravatar.com\/avatar\/540f47dd0fb41a572604e4bf8594c723?s=96&d=mm&r=g","contentUrl":"http:\/\/2.gravatar.com\/avatar\/540f47dd0fb41a572604e4bf8594c723?s=96&d=mm&r=g","caption":"Mike Williamson"},"sameAs":["https:\/\/3.88.229.156","https:\/\/twitter.com\/forensicmike1"],"url":"http:\/\/172.31.17.250\/author\/forensicmike\/"}]}},"_links":{"self":[{"href":"http:\/\/172.31.17.250\/wp-json\/wp\/v2\/posts\/199"}],"collection":[{"href":"http:\/\/172.31.17.250\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"http:\/\/172.31.17.250\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"http:\/\/172.31.17.250\/wp-json\/wp\/v2\/users\/2"}],"replies":[{"embeddable":true,"href":"http:\/\/172.31.17.250\/wp-json\/wp\/v2\/comments?post=199"}],"version-history":[{"count":12,"href":"http:\/\/172.31.17.250\/wp-json\/wp\/v2\/posts\/199\/revisions"}],"predecessor-version":[{"id":215,"href":"http:\/\/172.31.17.250\/wp-json\/wp\/v2\/posts\/199\/revisions\/215"}],"wp:featuredmedia":[{"embeddable":true,"href":"http:\/\/172.31.17.250\/wp-json\/wp\/v2\/media\/212"}],"wp:attachment":[{"href":"http:\/\/172.31.17.250\/wp-json\/wp\/v2\/media?parent=199"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http:\/\/172.31.17.250\/wp-json\/wp\/v2\/categories?post=199"},{"taxonomy":"post_tag","embeddable":true,"href":"http:\/\/172.31.17.250\/wp-json\/wp\/v2\/tags?post=199"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}