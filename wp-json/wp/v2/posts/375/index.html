{"id":375,"date":"2019-10-07T11:57:12","date_gmt":"2019-10-07T18:57:12","guid":{"rendered":"https:\/\/3.88.229.156\/?p=375"},"modified":"2019-10-07T18:53:23","modified_gmt":"2019-10-08T01:53:23","slug":"knowledgec-now-playing-entries","status":"publish","type":"post","link":"http:\/\/172.31.17.250\/2019\/10\/07\/knowledgec-now-playing-entries\/","title":{"rendered":"KnowledgeC: Now Playing entries"},"content":{"rendered":"\n<p>I know it&#8217;s been ages since I&#8217;ve posted! I have been settling in with Magnet Forensics and have to say &#8211; it&#8217;s been an incredible experience so far. I continue to be amazed and inspired by the dedication and skill of the folks who work tirelessly to make <a rel=\"noreferrer noopener\" aria-label=\"Magnet AXIOM (opens in a new tab)\" href=\"https:\/\/www.magnetforensics.com\/products\/magnet-axiom\/\" target=\"_blank\">Magnet AXIOM<\/a> and countless other products the absolute best they can be.<\/p>\n\n\n\n<p>I was recently helping out a customer with a question about an iPhone he was examining. He wanted to corroborate the device owner&#8217;s story &#8212; allegedly he had watched some videos on the device at a certain date and time.<\/p>\n\n\n\n<p>I suggested KnowledgeC &#8220;Now Playing&#8221; as a reference point and this led down a rabbit hole, namely:<\/p>\n\n\n\n<ul><li>Does clearing Safari history impact KnowledgeC.db?<\/li><li>Does private browsing affect input into KnowledgeC.db?<\/li><\/ul>\n\n\n\n<p>Answering these questions should be easy enough with the help of a jailbroken device (which I always keep near these days). I wanted to share my findings with the #DFIR community as there are some interesting things I observed along the way. Sarah Edwards herself noted in her blog series about KnowledgeC that there is more work to be done in terms of validating that the data is as it appears to be. I would say this work today follows down that path.<\/p>\n\n\n\n<p>One other thing to note. My jailbroken device is running iOS 11.4.1 and at the time of writing we are at iOS 13.1.2, so there could be a difference  between this and the latest\/greatest iOS version. First things first, I went into Safari and visited the first video that popped up on YouTube (do not have the YouTube app installed so it played in browser).<\/p>\n\n\n\n<figure class=\"wp-block-image is-resized\"><a href=\"https:\/\/cdn.shopify.com\/s\/files\/1\/2794\/3840\/articles\/Screen_Shot_2018-05-11_at_10.48.03_AM_800x.png?v=1526061025\"><img loading=\"lazy\" src=\"https:\/\/cdn.shopify.com\/s\/files\/1\/2794\/3840\/articles\/Screen_Shot_2018-05-11_at_10.48.03_AM_800x.png?v=1526061025\" alt=\"Image result for blippi\" width=\"278\" height=\"278\"\/><\/a><figcaption>I had no idea what &#8216;Blippi&#8217; was until clicking the first random video that came up on YouTube.com as trending. Lesson learned.<\/figcaption><\/figure>\n\n\n\n<p>Next, using SFTP I collected KnowledgeC.db from \/private\/var\/mobile\/Library\/CoreDuet\/Knowledge, including shm and wal, and opened DB Browser for SQLite. Next I ran <a rel=\"noreferrer noopener\" aria-label=\"Sarah Edward's Now Playing script (opens in a new tab)\" href=\"https:\/\/github.com\/mac4n6\/APOLLO\/blob\/master\/modules\/knowledge_audio_media_nowplaying.txt\" target=\"_blank\">Sarah Edwards&#8217; Now Playing script<\/a> (APOLLO) and here is what I observed:<\/p>\n\n\n\n<figure class=\"wp-block-image\"><a href=\"http:\/\/3.88.229.156\/wp-content\/uploads\/2019\/10\/image.png\"><img loading=\"lazy\" width=\"1024\" height=\"97\" src=\"http:\/\/3.88.229.156\/wp-content\/uploads\/2019\/10\/image-1024x97.png\" alt=\"\" class=\"wp-image-377\" srcset=\"http:\/\/172.31.17.250\/wp-content\/uploads\/2019\/10\/image-1024x97.png 1024w, http:\/\/172.31.17.250\/wp-content\/uploads\/2019\/10\/image-300x28.png 300w, http:\/\/172.31.17.250\/wp-content\/uploads\/2019\/10\/image-768x72.png 768w, http:\/\/172.31.17.250\/wp-content\/uploads\/2019\/10\/image.png 2003w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" \/><\/a><\/figure>\n\n\n\n<p>So far so good. I&#8217;d concur with the data here that I made it through an ad and about 3 seconds of the Blippi video before feeling immense regret end hitting the home button to stop that madness.. By the way, <em>Oct Edge Pre Roll<\/em> is an Ad, which at some point I skipped&#8230; but I&#8217;d say 15 seconds is conceivable for how long that all took.<\/p>\n\n\n\n<p>Next, I went back to my JB device and cleared all history through Settings &gt; Safari. I then pulled KnowledgeC and ran the query again. Nothing changed- it was exactly the same as before.<\/p>\n\n\n\n<p>Now things start to take a turn for the weird- I went to another video on Youtube within Safari and once again pulled my KnowledgeC db out:<\/p>\n\n\n\n<figure class=\"wp-block-image\"><a href=\"http:\/\/3.88.229.156\/wp-content\/uploads\/2019\/10\/image-1.png\"><img loading=\"lazy\" width=\"1024\" height=\"116\" src=\"http:\/\/3.88.229.156\/wp-content\/uploads\/2019\/10\/image-1-1024x116.png\" alt=\"\" class=\"wp-image-378\" srcset=\"http:\/\/172.31.17.250\/wp-content\/uploads\/2019\/10\/image-1-1024x116.png 1024w, http:\/\/172.31.17.250\/wp-content\/uploads\/2019\/10\/image-1-300x34.png 300w, http:\/\/172.31.17.250\/wp-content\/uploads\/2019\/10\/image-1-768x87.png 768w, http:\/\/172.31.17.250\/wp-content\/uploads\/2019\/10\/image-1.png 2019w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" \/><\/a><\/figure>\n\n\n\n<figure class=\"wp-block-image is-resized\"><img loading=\"lazy\" src=\"https:\/\/cdn.drawception.com\/images\/panels\/2018\/1-5\/Z5hGZATTmp-14.png\" alt=\"Image result for hmmm emote\" width=\"135\" height=\"113\"\/><\/figure>\n\n\n\n<p>So&#8230;..the new video is missing altogether, but even more strangely there is an <strong>additional <\/strong>entry of Blippi (note the entry creation is about 5 minutes after the fact) stating a &#8216;Usage in Seconds&#8217; of <span style=\"text-decoration: underline;\">319<\/span>.  (Note that the Usage in Seconds column is actually a computation of ZENDDATE &#8211; ZSTARTDATE that Sarah has provided for us.)<\/p>\n\n\n\n<p>A few things we might surmise from this:<\/p>\n\n\n\n<ul><li>Even with Safari suspended and history cleared, if I were to lock my screen I suspect it would show my &#8220;Now Playing&#8221; of the Blippi video. It wasn&#8217;t until I went to a different video that it got changed.<br><\/li><li>KnowledgeC writes are not guaranteed to be immediate and definitely do not on their own reflect active viewing time.<\/li><\/ul>\n\n\n\n<p>I then watched the same video again and once again pulled my KnowledgeC. This time, I got the new entry as expected:<\/p>\n\n\n\n<figure class=\"wp-block-image\"><a href=\"http:\/\/3.88.229.156\/wp-content\/uploads\/2019\/10\/image-2.png\"><img loading=\"lazy\" width=\"1024\" height=\"156\" src=\"http:\/\/3.88.229.156\/wp-content\/uploads\/2019\/10\/image-2-1024x156.png\" alt=\"\" class=\"wp-image-379\" srcset=\"http:\/\/172.31.17.250\/wp-content\/uploads\/2019\/10\/image-2-1024x156.png 1024w, http:\/\/172.31.17.250\/wp-content\/uploads\/2019\/10\/image-2-300x46.png 300w, http:\/\/172.31.17.250\/wp-content\/uploads\/2019\/10\/image-2-768x117.png 768w, http:\/\/172.31.17.250\/wp-content\/uploads\/2019\/10\/image-2.png 2016w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" \/><\/a><\/figure>\n\n\n\n<p>To answer the other question, as to whether or not private browsing makes a difference with respect to KnowledgeC Now Playing records. I then visited more YouTube videos in &#8216;Private Mode&#8217; on Safari:<\/p>\n\n\n\n<figure class=\"wp-block-image\"><a href=\"http:\/\/3.88.229.156\/wp-content\/uploads\/2019\/10\/image-3.png\"><img loading=\"lazy\" width=\"1024\" height=\"200\" src=\"http:\/\/3.88.229.156\/wp-content\/uploads\/2019\/10\/image-3-1024x200.png\" alt=\"\" class=\"wp-image-380\" srcset=\"http:\/\/172.31.17.250\/wp-content\/uploads\/2019\/10\/image-3-1024x200.png 1024w, http:\/\/172.31.17.250\/wp-content\/uploads\/2019\/10\/image-3-300x59.png 300w, http:\/\/172.31.17.250\/wp-content\/uploads\/2019\/10\/image-3-768x150.png 768w, http:\/\/172.31.17.250\/wp-content\/uploads\/2019\/10\/image-3.png 2027w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" \/><\/a><\/figure>\n\n\n\n<p>They showed up just the same.<\/p>\n\n\n\n<p>One last note. After all of this I did a KnowledgeC-wide query to see what kind of imprint I left beyond the Now Playing results:<\/p>\n\n\n\n<figure class=\"wp-block-image\"><a href=\"http:\/\/3.88.229.156\/wp-content\/uploads\/2019\/10\/image-4.png\"><img loading=\"lazy\" width=\"815\" height=\"912\" src=\"http:\/\/3.88.229.156\/wp-content\/uploads\/2019\/10\/image-4.png\" alt=\"\" class=\"wp-image-381\" srcset=\"http:\/\/172.31.17.250\/wp-content\/uploads\/2019\/10\/image-4.png 815w, http:\/\/172.31.17.250\/wp-content\/uploads\/2019\/10\/image-4-268x300.png 268w, http:\/\/172.31.17.250\/wp-content\/uploads\/2019\/10\/image-4-768x859.png 768w\" sizes=\"(max-width: 815px) 100vw, 815px\" \/><\/a><\/figure>\n\n\n\n<p>And there you have it. I think with \/app\/inFocus rows it is a much clearer picture of the fact that I did not in fact spend a lot of time watching any one video. The moral of the story here is that KnowledgeC data is indeed amazing, but not without its nuances. You must build your story based on the totality of ALL relevant KnowledgeC records, and avoid dwelling solely on the information derived from a single log type or row.<\/p>\n","protected":false},"excerpt":{"rendered":"<p>I know it&#8217;s been ages since I&#8217;ve posted! I have been settling in with Magnet Forensics and have to say &#8211; it&#8217;s been an incredible experience so far. I continue to be amazed and inspired by the dedication and skill of the folks who work tirelessly to make Magnet AXIOM and countless other products the [&hellip;]<\/p>\n","protected":false},"author":2,"featured_media":384,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"_mi_skip_tracking":false},"categories":[33,26,1],"tags":[10,11,34],"yoast_head":"<!-- This site is optimized with the Yoast SEO plugin v19.4 - https:\/\/yoast.com\/wordpress\/plugins\/seo\/ -->\n<title>KnowledgeC: Now Playing entries - forensicmike1<\/title>\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" \/>\n<link rel=\"canonical\" href=\"https:\/\/www.forensicmike1.com\/2019\/10\/07\/knowledgec-now-playing-entries\/\" \/>\n<meta property=\"og:locale\" content=\"en_US\" \/>\n<meta property=\"og:type\" content=\"article\" \/>\n<meta property=\"og:title\" content=\"KnowledgeC: Now Playing entries - forensicmike1\" \/>\n<meta property=\"og:description\" content=\"I know it&#8217;s been ages since I&#8217;ve posted! I have been settling in with Magnet Forensics and have to say &#8211; it&#8217;s been an incredible experience so far. I continue to be amazed and inspired by the dedication and skill of the folks who work tirelessly to make Magnet AXIOM and countless other products the [&hellip;]\" \/>\n<meta property=\"og:url\" content=\"https:\/\/www.forensicmike1.com\/2019\/10\/07\/knowledgec-now-playing-entries\/\" \/>\n<meta property=\"og:site_name\" content=\"forensicmike1\" \/>\n<meta property=\"article:published_time\" content=\"2019-10-07T18:57:12+00:00\" \/>\n<meta property=\"article:modified_time\" content=\"2019-10-08T01:53:23+00:00\" \/>\n<meta property=\"og:image\" content=\"https:\/\/www.forensicmike1.com\/wp-content\/uploads\/2019\/10\/knowledgec_mnp.png\" \/>\n\t<meta property=\"og:image:width\" content=\"958\" \/>\n\t<meta property=\"og:image:height\" content=\"631\" \/>\n\t<meta property=\"og:image:type\" content=\"image\/png\" \/>\n<meta name=\"author\" content=\"Mike Williamson\" \/>\n<meta name=\"twitter:card\" content=\"summary_large_image\" \/>\n<meta name=\"twitter:creator\" content=\"@forensicmike1\" \/>\n<meta name=\"twitter:label1\" content=\"Written by\" \/>\n\t<meta name=\"twitter:data1\" content=\"Mike Williamson\" \/>\n\t<meta name=\"twitter:label2\" content=\"Est. reading time\" \/>\n\t<meta name=\"twitter:data2\" content=\"4 minutes\" \/>\n<script type=\"application\/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https:\/\/schema.org\",\"@graph\":[{\"@type\":\"WebSite\",\"@id\":\"http:\/\/172.31.17.250\/#website\",\"url\":\"http:\/\/172.31.17.250\/\",\"name\":\"forensicmike1\",\"description\":\"#DFIR | #RE | #OtherGeekThings =&gt; Views expressed are my own.\",\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":{\"@type\":\"EntryPoint\",\"urlTemplate\":\"http:\/\/172.31.17.250\/?s={search_term_string}\"},\"query-input\":\"required name=search_term_string\"}],\"inLanguage\":\"en-US\"},{\"@type\":\"WebPage\",\"@id\":\"https:\/\/www.forensicmike1.com\/2019\/10\/07\/knowledgec-now-playing-entries\/\",\"url\":\"https:\/\/www.forensicmike1.com\/2019\/10\/07\/knowledgec-now-playing-entries\/\",\"name\":\"KnowledgeC: Now Playing entries - forensicmike1\",\"isPartOf\":{\"@id\":\"http:\/\/172.31.17.250\/#website\"},\"datePublished\":\"2019-10-07T18:57:12+00:00\",\"dateModified\":\"2019-10-08T01:53:23+00:00\",\"author\":{\"@id\":\"http:\/\/172.31.17.250\/#\/schema\/person\/9452bbb839546322f3705877143ce492\"},\"breadcrumb\":{\"@id\":\"https:\/\/www.forensicmike1.com\/2019\/10\/07\/knowledgec-now-playing-entries\/#breadcrumb\"},\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https:\/\/www.forensicmike1.com\/2019\/10\/07\/knowledgec-now-playing-entries\/\"]}]},{\"@type\":\"BreadcrumbList\",\"@id\":\"https:\/\/www.forensicmike1.com\/2019\/10\/07\/knowledgec-now-playing-entries\/#breadcrumb\",\"itemListElement\":[{\"@type\":\"ListItem\",\"position\":1,\"name\":\"Home\",\"item\":\"http:\/\/172.31.17.250\/\"},{\"@type\":\"ListItem\",\"position\":2,\"name\":\"KnowledgeC: Now Playing entries\"}]},{\"@type\":\"Person\",\"@id\":\"http:\/\/172.31.17.250\/#\/schema\/person\/9452bbb839546322f3705877143ce492\",\"name\":\"Mike Williamson\",\"image\":{\"@type\":\"ImageObject\",\"inLanguage\":\"en-US\",\"@id\":\"http:\/\/172.31.17.250\/#\/schema\/person\/image\/\",\"url\":\"http:\/\/2.gravatar.com\/avatar\/540f47dd0fb41a572604e4bf8594c723?s=96&d=mm&r=g\",\"contentUrl\":\"http:\/\/2.gravatar.com\/avatar\/540f47dd0fb41a572604e4bf8594c723?s=96&d=mm&r=g\",\"caption\":\"Mike Williamson\"},\"sameAs\":[\"https:\/\/3.88.229.156\",\"https:\/\/twitter.com\/forensicmike1\"],\"url\":\"http:\/\/172.31.17.250\/author\/forensicmike\/\"}]}<\/script>\n<!-- \/ Yoast SEO plugin. -->","yoast_head_json":{"title":"KnowledgeC: Now Playing entries - forensicmike1","robots":{"index":"index","follow":"follow","max-snippet":"max-snippet:-1","max-image-preview":"max-image-preview:large","max-video-preview":"max-video-preview:-1"},"canonical":"https:\/\/www.forensicmike1.com\/2019\/10\/07\/knowledgec-now-playing-entries\/","og_locale":"en_US","og_type":"article","og_title":"KnowledgeC: Now Playing entries - forensicmike1","og_description":"I know it&#8217;s been ages since I&#8217;ve posted! I have been settling in with Magnet Forensics and have to say &#8211; it&#8217;s been an incredible experience so far. I continue to be amazed and inspired by the dedication and skill of the folks who work tirelessly to make Magnet AXIOM and countless other products the [&hellip;]","og_url":"https:\/\/www.forensicmike1.com\/2019\/10\/07\/knowledgec-now-playing-entries\/","og_site_name":"forensicmike1","article_published_time":"2019-10-07T18:57:12+00:00","article_modified_time":"2019-10-08T01:53:23+00:00","og_image":[{"width":958,"height":631,"url":"https:\/\/www.forensicmike1.com\/wp-content\/uploads\/2019\/10\/knowledgec_mnp.png","type":"image\/png"}],"author":"Mike Williamson","twitter_card":"summary_large_image","twitter_creator":"@forensicmike1","twitter_misc":{"Written by":"Mike Williamson","Est. reading time":"4 minutes"},"schema":{"@context":"https:\/\/schema.org","@graph":[{"@type":"WebSite","@id":"http:\/\/172.31.17.250\/#website","url":"http:\/\/172.31.17.250\/","name":"forensicmike1","description":"#DFIR | #RE | #OtherGeekThings =&gt; Views expressed are my own.","potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"http:\/\/172.31.17.250\/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"WebPage","@id":"https:\/\/www.forensicmike1.com\/2019\/10\/07\/knowledgec-now-playing-entries\/","url":"https:\/\/www.forensicmike1.com\/2019\/10\/07\/knowledgec-now-playing-entries\/","name":"KnowledgeC: Now Playing entries - forensicmike1","isPartOf":{"@id":"http:\/\/172.31.17.250\/#website"},"datePublished":"2019-10-07T18:57:12+00:00","dateModified":"2019-10-08T01:53:23+00:00","author":{"@id":"http:\/\/172.31.17.250\/#\/schema\/person\/9452bbb839546322f3705877143ce492"},"breadcrumb":{"@id":"https:\/\/www.forensicmike1.com\/2019\/10\/07\/knowledgec-now-playing-entries\/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https:\/\/www.forensicmike1.com\/2019\/10\/07\/knowledgec-now-playing-entries\/"]}]},{"@type":"BreadcrumbList","@id":"https:\/\/www.forensicmike1.com\/2019\/10\/07\/knowledgec-now-playing-entries\/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"http:\/\/172.31.17.250\/"},{"@type":"ListItem","position":2,"name":"KnowledgeC: Now Playing entries"}]},{"@type":"Person","@id":"http:\/\/172.31.17.250\/#\/schema\/person\/9452bbb839546322f3705877143ce492","name":"Mike Williamson","image":{"@type":"ImageObject","inLanguage":"en-US","@id":"http:\/\/172.31.17.250\/#\/schema\/person\/image\/","url":"http:\/\/2.gravatar.com\/avatar\/540f47dd0fb41a572604e4bf8594c723?s=96&d=mm&r=g","contentUrl":"http:\/\/2.gravatar.com\/avatar\/540f47dd0fb41a572604e4bf8594c723?s=96&d=mm&r=g","caption":"Mike Williamson"},"sameAs":["https:\/\/3.88.229.156","https:\/\/twitter.com\/forensicmike1"],"url":"http:\/\/172.31.17.250\/author\/forensicmike\/"}]}},"_links":{"self":[{"href":"http:\/\/172.31.17.250\/wp-json\/wp\/v2\/posts\/375"}],"collection":[{"href":"http:\/\/172.31.17.250\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"http:\/\/172.31.17.250\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"http:\/\/172.31.17.250\/wp-json\/wp\/v2\/users\/2"}],"replies":[{"embeddable":true,"href":"http:\/\/172.31.17.250\/wp-json\/wp\/v2\/comments?post=375"}],"version-history":[{"count":19,"href":"http:\/\/172.31.17.250\/wp-json\/wp\/v2\/posts\/375\/revisions"}],"predecessor-version":[{"id":400,"href":"http:\/\/172.31.17.250\/wp-json\/wp\/v2\/posts\/375\/revisions\/400"}],"wp:featuredmedia":[{"embeddable":true,"href":"http:\/\/172.31.17.250\/wp-json\/wp\/v2\/media\/384"}],"wp:attachment":[{"href":"http:\/\/172.31.17.250\/wp-json\/wp\/v2\/media?parent=375"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http:\/\/172.31.17.250\/wp-json\/wp\/v2\/categories?post=375"},{"taxonomy":"post_tag","embeddable":true,"href":"http:\/\/172.31.17.250\/wp-json\/wp\/v2\/tags?post=375"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}